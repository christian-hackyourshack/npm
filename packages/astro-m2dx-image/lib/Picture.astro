---
import Picture from './PatchedPicture.astro';
import type { CallbackProps, PictureProps } from './types';
import { getWidth, resolveSrc } from './utils';

export interface Props extends PictureProps {}

let { callback, ...props } = Astro.props as Props;
await resolveSrc(props);
callback && (await callback(props as CallbackProps));

if (!props.widths || props.widths.length === 0) {
  props.widths = [getWidth(props) ?? 480];
}
---

<Picture {...props} />
